"use strict";(self.webpackChunkbrojoon=self.webpackChunkbrojoon||[]).push([[567],{4567:function(e,n,t){t.r(n),t.d(n,{default:function(){return O}});var r,o,a,i=t(7294),u=t(9669),s=t.n(u),c=t(4901),l=t(5977),d=t(9062),f=t(3564),m=t(2503),p=t(4524).Z.div(r||(o=["\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\twidth: 100%;\n\tflex-direction: column;\n\theight: 100vh;\n\n\tcolor: white;\n\n\t& .progress {\n\t\tcolor: white;\n\t}\n"],a||(a=o.slice(0)),r=Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(a)}})))),h=t(2132),g=t(6103);function v(e,n,t,r,o,a,i){try{var u=e[a](i),s=u.value}catch(e){return void t(e)}u.done?n(s):Promise.resolve(s).then(r,o)}var I={withCredentials:!0},O=function(){var e=(0,m.ZP)("/api/users",f.Z).data,n=(0,i.useContext)(g.J).onGameList,t=(0,l.k6)(),r=(0,c.Z)();(0,i.useEffect)((function(){n&&e&&n[e.userId]&&(t.push("/home"),h.Am.error("Already playing game",{autoClose:2e3,position:h.Am.POSITION.TOP_RIGHT,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,theme:"colored"}))}),[n,e]),(0,i.useEffect)((function(){return e&&r.emit("matching",{userId:null==e?void 0:e.userId,gameId:0}),function(){e&&r.emit("outMatching",{userId:null==e?void 0:e.userId})}}),[e,r]);var o=(0,i.useCallback)(function(){var n,o=(n=regeneratorRuntime.mark((function n(o){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s().post("/api/dms/sendMessage/".concat(o.playerTwo,"/1/0"),{message:""},I).then((function(n){r.emit("matching",{userId:null==e?void 0:e.userId,gameId:n.data}),t.push("/game/ping-pong/".concat(n.data))})).catch((function(e){h.Am.error(e.message,{autoClose:4e3,position:h.Am.POSITION.TOP_RIGHT,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,theme:"colored"}),setTimeout((function(){t.push("/home")}),4e3)}));case 2:case"end":return n.stop()}}),n)})),function(){var e=this,t=arguments;return new Promise((function(r,o){var a=n.apply(e,t);function i(e){v(a,r,o,i,u,"next",e)}function u(e){v(a,r,o,i,u,"throw",e)}i(void 0)}))});return function(e){return o.apply(this,arguments)}}(),[e,r]);return(0,i.useEffect)((function(){return r.on("matched",(function(n){(null==e?void 0:e.userId)===n.playerOne&&0===n.gameId?o(n):(null==e?void 0:e.userId)===n.playerTwo&&0!==n.gameId&&t.push("/game/ping-pong/".concat(n.gameId))})),function(){r.off("matched")}}),[r,e,o]),i.createElement(p,null,i.createElement(d.Z,{className:"progress"}),i.createElement("h1",null,"Waiting for opponent..."))}}}]);