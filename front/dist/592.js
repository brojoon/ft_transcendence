"use strict";(self.webpackChunkbrojoon=self.webpackChunkbrojoon||[]).push([[592],{2592:function(e,t,n){n.r(t),n.d(t,{default:function(){return re}});var a,r,l,i=n(7294),o=n(9669),c=n.n(o),u=n(3284),s=(n(5666),n(5977)),d=n(2503),m=n(3564),f=n(7109),p=n(2642),y=n(3570),g=n(1298),h=n(8979),v=n(3784),b=n(4524),E=b.Z.div(a||(r=["\n\tborder: 5px solid #ffffff;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n"],l||(l=r.slice(0)),a=Object.freeze(Object.defineProperties(r,{raw:{value:Object.freeze(l)}}))));function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,l=[],i=!0,o=!1;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(l.push(a.value),!t||l.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{i||null==n.return||n.return()}finally{if(o)throw r}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var I=(0,u.Z)();h.Xdb.SCALE_MODE=h.aH$.NEAREST;var x,O=(0,v.PixiComponent)("Rectangle",{create:function(){return new h.TCu},applyProps:function(e,t,n){var a=n.fill,r=n.x,l=n.y,i=n.width,o=n.height;e.clear(),e.beginFill(a),e.drawRect(r,l,i,o),e.endFill()}}),Z=(0,v.PixiComponent)("Circle",{create:function(){return new h.TCu},applyProps:function(e,t,n){var a=n.fill,r=n.x,l=n.y,i=n.radius;e.clear(),e.beginFill(a),e.drawCircle(r,l,i),e.endFill()}}),C=function(e){var t=e.mapSelect,n=e.player,a=e.setGameStartBtn,r=(0,s.UO)().id,l=w((0,i.useState)(500),2),o=l[0],c=l[1],u=w((0,i.useState)(250),2),d=u[0],m=u[1],f=w((0,i.useState)(200),2),p=f[0],y=f[1],g=w((0,i.useState)(200),2),h=g[0],b=g[1];return(0,s.k6)(),(0,i.useEffect)((function(){a(!0)}),[]),(0,i.useEffect)((function(){return I.on("gameInfo",(function(e){c(e.ball_x),m(e.ball_y),500===e.ball_x&&250===e.ball_y?a(!0):a(!1)})),function(){I.off("gameInfo")}}),[I]),(0,i.useEffect)((function(){return I.on("player_one",(function(e){y(e.player_one_y)})),function(){I.off("player_one")}}),[I]),(0,i.useEffect)((function(){return I.on("player_two",(function(e){b(e.player_two_y)})),function(){I.off("player_two")}}),[I]),(0,i.useEffect)((function(){document.addEventListener("keydown",(function(e){87===e.keyCode&&""!==n?"playerOne"===n?I.emit("player_one_up",{game:r}):"playerTwo"===n&&I.emit("player_two_up",{game:r}):83===e.keyCode&&""!==n&&("playerOne"===n?I.emit("player_one_down",{game:r}):"playerTwo"===n&&I.emit("player_two_down",{game:r}))}),!1)}),[n,r]),i.createElement(E,null,i.createElement(v.Stage,{width:1e3,height:500,options:{antialias:!0,backgroundColor:3563007}},i.createElement(O,{x:0,y:p,width:15,height:100,fill:16777215}),i.createElement(O,{x:985,y:h,width:15,height:100,fill:16777215}),1===t?i.createElement(O,{x:350,y:100,width:300,height:50,fill:2503224}):null,1===t?i.createElement(O,{x:350,y:350,width:300,height:50,fill:2503224}):null,i.createElement(Z,{x:o,y:d,radius:10,fill:16777215})))},k=n(7666),j=n(1275),M=n(6446),P=n(8641),_=b.Z.div(x||(x=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n\tdisplay: flex;\n\tflex-direction: row;\n\tmargin-top: 20px;\n\n\t& .css-1kty9di-MuiFormLabel-root-MuiInputLabel-root {\n\t\tcolor: white;\n\t}\n\n\t& .css-11u53oe-MuiSelect-select-MuiInputBase-input-MuiOutlinedInput-input.css-11u53oe-MuiSelect-select-MuiInputBase-input-MuiOutlinedInput-input.css-11u53oe-MuiSelect-select-MuiInputBase-input-MuiOutlinedInput-input {\n\t\tcolor: white;\n\t}\n\n\t& .css-hfutr2-MuiSvgIcon-root-MuiSelect-icon {\n\t\tcolor: rgba(255, 255, 255, 0.54);\n\t}\n\n\t& .css-bpeome-MuiSvgIcon-root-MuiSelect-icon {\n\t\tcolor: rgba(255, 255, 255, 1);\n\t}\n\n\t& .css-1d3z3hw-MuiOutlinedInput-notchedOutline {\n\t\tborder-color: rgba(255, 255, 255, 0.5);\n\t}\n\n\t& .css-9ddj71-MuiInputBase-root-MuiOutlinedInput-root:hover\n\t\t.MuiOutlinedInput-notchedOutline {\n\t\tborder-color: rgba(255, 255, 255, 1);\n\n\t}\n"])));function A(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,l=[],i=!0,o=!1;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(l.push(a.value),!t||l.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{i||null==n.return||n.return()}finally{if(o)throw r}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?T(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var R,N,B,G,z,H,J=(0,u.Z)(),U=function(e){var t=e.player1Ready,n=e.player2Ready,a=e.player,r=e.mapSelect,l=e.setMapSelect,o=(0,s.UO)().id,c=A((0,i.useState)(2),2),u=c[0],d=c[1],m=A((0,i.useState)(3),2),f=m[0],p=m[1],y=A((0,i.useState)(0),2),g=y[0],h=y[1],v=(0,i.useCallback)((function(e){t||n||!a||o&&J.emit("changeGameSet",{gameId:o,speed:e.target.value,set:f,map:r,random:g})}),[t,n,f,g,r,a,o]),b=(0,i.useCallback)((function(e){t||n||!a||o&&J.emit("changeGameSet",{gameId:o,speed:u,set:f,map:e.target.value,random:g})}),[t,n,f,g,u,o,a]),E=(0,i.useCallback)((function(e){t||n||!a||o&&J.emit("changeGameSet",{gameId:o,speed:u,set:e.target.value,map:r,random:g})}),[t,n,g,r,u,o,a]),w=(0,i.useCallback)((function(e){t||n||!a||o&&J.emit("changeGameSet",{gameId:o,speed:u,set:f,map:r,random:e.target.value})}),[t,n,f,r,u,o,a]);return(0,i.useEffect)((function(){return J.on("gameSet",(function(e){d(e.length),p(e.game_set),l(e.game_map),h(e.random_map)})),function(){J.off("gameSet")}}),[]),i.createElement(_,null,i.createElement(M.Z,{fullWidth:!0},i.createElement(k.Z,{id:"demo-simple-select-label"},"게임판수"),i.createElement(P.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:f,label:"게임판수",onChange:E},i.createElement(j.Z,{value:3},"3"),i.createElement(j.Z,{value:5},"5"))),i.createElement(M.Z,{fullWidth:!0},i.createElement(k.Z,{id:"demo-simple-select-label"},"맵선택"),i.createElement(P.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:r,label:"맵선택",onChange:b},i.createElement(j.Z,{value:0},"Normal"),i.createElement(j.Z,{value:1},"obstacle"))),i.createElement(M.Z,{fullWidth:!0},i.createElement(k.Z,{id:"demo-simple-select-label"},"Speed"),i.createElement(P.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:u,label:"Speed",onChange:v},i.createElement(j.Z,{value:2},"1단계"),i.createElement(j.Z,{value:3},"2단계"),i.createElement(j.Z,{value:4},"3단계"))),i.createElement(M.Z,{fullWidth:!0},i.createElement(k.Z,{id:"demo-simple-select-label"},"ballRandom"),i.createElement(P.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:g,label:"ballRandom",onChange:w},i.createElement(j.Z,{value:0},"Normal"),i.createElement(j.Z,{value:1},"Random"))))},F=n(2132);function L(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var W=b.Z.div(R||(R=L(["\n\theight: 100vh;\n\twidth: 100%;\n\tbackground-color: #424242;\n"]))),$=b.Z.div(N||(N=L(["\n\tbackground-color: #424242;\n\tmargin: 0;\n\twidth: 100%;\n\theight: 100%;\n\tcolor: white;\n\n\t& .pixi-container {\n\t\tborder: 5px solid #ffffff;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t}\n"]))),V=b.Z.div(B||(B=L(["\n\tdisplay: flex;\n\tjustify-content: space-around;\n\talign-items: center;\n\tmargin: 20px;\n\n\t& .player-one-container {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t}\n\n\t& .player-one-avatar {\n\t\twidth: 300px;\n\t\theight: 300px;\n\t}\n\n\t& .player-one-text {\n\t\tmargin: 10px 0;\n\t}\n\n\n\t& .versus {\n\t\tfont-weight: 700;\n\t\tfont-size: 30px;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t}\n\n\t& .player-two-container {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t}\n\n\t& .player-two-avatar {\n\t\twidth: 300px;\n\t\theight: 300px;\n\t}\n\n\t& .player-two-text {\n\t\tmargin: 10px 0;\n\t}\n\n\n\t& .css-sghohy-MuiButtonBase-root-MuiButton-root.Mui-disabled {\n\t\tcolor: white;\n\t}\n\n"]))),D=b.Z.div(G||(G=L(["\n\tdisplay: flex;\n\tjustify-content: space-between;\n\tpadding: 10px 15px;\n\n\t& .point-wrapper {\n\t\tdisplay: flex;\n\t}\n\n\t& .point-icon {\n\t\tfont-size: 27px;\n\t}\n\n"]))),X=b.Z.div(z||(z=L(["\n\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\tflex-direction: column;\n\twidth: ",";\n\n\t& .game-btn {\n\t\tcolor: white;\n\t}\n\n\t& .game-text {\n\t\tmargin-top: 5px;\n\t}\n"])),(function(e){return e.width})),q=b.Z.div(H||(H=L(["\n  ...style;\n  background-color: #787c7f;\n  width: 8px;\n  border-radius: 5px;\n\n\t&:hover {\n\t\tbackground-color: white;\n\t}\n"]))),K=["style"];function Q(e,t,n,a,r,l,i){try{var o=e[l](i),c=o.value}catch(e){return void n(e)}o.done?t(c):Promise.resolve(c).then(a,r)}function Y(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var l=e.apply(t,n);function i(e){Q(l,a,r,i,o,"next",e)}function o(e){Q(l,a,r,i,o,"throw",e)}i(void 0)}))}}function ee(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,l=[],i=!0,o=!1;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(l.push(a.value),!t||l.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{i||null==n.return||n.return()}finally{if(o)throw r}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return te(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?te(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function te(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var ne=(0,u.Z)(),ae={withCredentials:!0},re=function(){var e=(0,s.UO)().id,t=(0,d.ZP)("/api/users",m.Z).data,n=(0,d.ZP)("/api/users/alluser",m.Z).data,a=ee((0,i.useState)(0),2),r=a[0],l=a[1],o=ee((0,i.useState)(0),2),u=o[0],h=o[1],v=ee((0,i.useState)(0),2),b=v[0],E=v[1],w=ee((0,i.useState)(0),2),S=w[0],I=w[1],x=ee((0,i.useState)(""),2),O=x[0],Z=x[1],k=ee((0,i.useState)(!1),2),j=k[0],M=k[1],P=ee((0,i.useState)(""),2),_=P[0],A=P[1],T=ee((0,i.useState)(""),2),R=T[0],N=T[1],B=ee((0,i.useState)(""),2),G=(B[0],B[1]),z=ee((0,i.useState)(0),2),H=z[0],J=z[1],L=ee((0,i.useState)(""),2),Q=L[0],te=L[1],re=ee((0,i.useState)(""),2),le=re[0],ie=re[1],oe=ee((0,i.useState)(""),2),ce=oe[0],ue=oe[1],se=ee((0,i.useState)(""),2),de=se[0],me=se[1],fe=ee((0,i.useState)(""),2),pe=fe[0],ye=fe[1],ge=ee((0,i.useState)(""),2),he=ge[0],ve=ge[1],be=ee((0,i.useState)(!1),2),Ee=be[0],we=be[1],Se=(0,s.k6)();(0,i.useEffect)((function(){ne.on("gameStart",(function(e){return e.gameStart&&(M(!0),l(1),h(1)),function(){ne.off("gameStart")}}))}),[ne]),(0,i.useEffect)((function(){e&&ne.emit("gameCheck",{gameId:e})}),[e,ne]),(0,i.useEffect)((function(){return t&&e&&ne.emit("onGame",{gameId:e,player:t.userId}),function(){t&&ne.emit("offGame",{gameId:e,player:t.userId})}}),[ne,t,e]),(0,i.useEffect)((function(){t&&(null==n||n.map((function(e){e.userId===_&&(G(e.profile),N(e.username)),e.userId===Q&&(ue(e.profile),ye(e.username)),e.userId===le&&(me(e.profile),ve(e.username))})))}),[t,_,n,Q,le]),(0,i.useEffect)((function(){function n(){return(n=Y(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,c().get("/api/game/history/".concat(e),ae).then((function(n){2===n.data.state&&Se.push("/game/history/".concat(e)),(null==t?void 0:t.userId)===n.data.userId1?(Z("playerOne"),A(n.data.userId2),h(n.data.playerTwoJoin),ne.emit("game",{gameId:e,player:"playerOne",player1Ready:0,player2Ready:n.data.playerTwoJoin})):(null==t?void 0:t.userId)===n.data.userId2?(Z("playerTwo"),l(n.data.playerOneJoin),A(n.data.userId1),ne.emit("game",{gameId:e,player:"playerTwo",player1Ready:n.data.playerOneJoin,player2Ready:0})):ne.emit("game",{gameId:e,player:"",player1Ready:n.data.playerOneJoin,player2Ready:n.data.playerTwoJoin}),te(n.data.userId1),ie(n.data.userId2),ne.emit("changeGameSet",{gameId:e,check:"check"}),ne.emit("gamePoint",{gameId:e,user1Point:n.data.user1Point,user2Point:n.data.user2Point})})).catch((function(e){F.Am.error(e.message,{autoClose:3e3,position:F.Am.POSITION.TOP_RIGHT,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,theme:"colored"}),setTimeout((function(){Se.push("/home")}),3e3)}));case 2:case"end":return n.stop()}}),n)})))).apply(this,arguments)}null!=t&&t.userId&&function(){n.apply(this,arguments)}()}),[e,t]),(0,i.useEffect)((function(){return ne.on("point",(function(e){E(e.player1),I(e.player2)})),function(){ne.off("point")}}),[]),(0,i.useEffect)((function(){return ne.on("end",(function(){Se.push("/game/history/".concat(e))})),function(){ne.off("end")}}),[e]),(0,i.useEffect)((function(){return ne.on("ready",(function(e){l(e.player1),h(e.player2),1===e.player1&&1===e.player2&&we(!0)})),function(){ne.off("ready")}}),[]),(0,i.useEffect)((function(){return ne.on("gameMapCheck",(function(e){J(e.game_map)})),function(){ne.off("gameMapCheck")}}),[ne]);var Ie=(0,i.useCallback)((function(){"playerOne"===O&&0===r&&ne.emit("gameReady",{gameId:e,player:1,userId:null==t?void 0:t.userId})}),[ne,e,t,O,r]),xe=(0,i.useCallback)((function(){"playerTwo"===O&&0===u&&ne.emit("gameReady",{gameId:e,player:2,userId:null==t?void 0:t.userId})}),[ne,e,t,O,u]),Oe=(0,i.useCallback)((function(){""!==O&&c().get("/api/game/start/".concat(e),ae).catch((function(e){Se.push("./home"),F.Am.error(e.message,{autoClose:3e3,position:F.Am.POSITION.TOP_RIGHT,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,theme:"colored"})}))}),[e,O,ae]);return i.createElement(W,{className:"bg"},i.createElement(g.ZP,{autoHide:!0,renderThumbVertical:function(e){e.style;var t=function(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}(e,K);return i.createElement(q,t)}},i.createElement($,null,j&&i.createElement(C,{mapSelect:H,player:O,setGameStartBtn:we}),!j&&i.createElement(U,{player1Ready:r,player2Ready:u,player:O,mapSelect:H,setMapSelect:J}),!j&&i.createElement(V,null,i.createElement("div",{className:"player-one-container"},i.createElement("div",null,i.createElement(f.Z,{className:"player-one-avatar",src:ce,alt:"Avatar"})),i.createElement("div",{className:"player-one-text"},"playerOne"===O?(null==t?void 0:t.username)+" (나)":""!==O?R+" (상대편)":pe),i.createElement("div",null,"playerOne"===O?0===r?i.createElement(p.Z,{variant:"contained",onClick:Ie},"ready"):i.createElement(p.Z,{variant:"contained",disabled:!0},"완료"):0===r?i.createElement(p.Z,{variant:"contained",disabled:!0},"준비중.."):i.createElement(p.Z,{variant:"contained",disabled:!0},"완료"))),i.createElement("div",{className:"versus"},i.createElement("div",null,"VS")),i.createElement("div",{className:"player-two-container"},i.createElement("div",null,i.createElement(f.Z,{className:"player-two-avatar",src:de,alt:"Avatar"})),i.createElement("div",{className:"player-two-text"},"playerTwo"===O?(null==t?void 0:t.username)+" (나)":""!==O?R+" (상대편)":he),i.createElement("div",null,"playerTwo"===O?0===u?i.createElement(p.Z,{variant:"contained",onClick:xe},"ready"):i.createElement(p.Z,{variant:"contained",disabled:!0},"완료"):0===u?i.createElement(p.Z,{variant:"contained",disabled:!0},"준비중.."):i.createElement(p.Z,{variant:"contained",disabled:!0},"완료")))),i.createElement(D,null,j&&i.createElement("div",{className:"point-wrapper"},pe+" Point",i.createElement(y.Z,{className:"point-icon"})," ",": [ "+b+" ] "),j&&i.createElement("div",{className:"point-wrapper"},he+" Point",i.createElement(y.Z,{className:"point-icon"})," ",": [ "+S+" ] ")),i.createElement(X,{width:"".concat(j?"":"100%")},""===O?null:Ee?i.createElement(p.Z,{className:"game-btn",variant:"contained",onClick:Oe},"게임시작"):i.createElement(p.Z,{className:"game-btn",variant:"contained",disabled:!0},"게임시작"),""===O||j?null:i.createElement("div",{className:"game-text"}," (모두 레디 시 시작됨)"),""===O?i.createElement("h2",null,"관전중..."):i.createElement("div",null,"(up: w / down: s)")))))}}}]);