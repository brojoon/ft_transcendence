"use strict";(self.webpackChunkbrojoon=self.webpackChunkbrojoon||[]).push([[355],{4355:function(t,e,n){n.r(e),n.d(e,{default:function(){return U}});var r,a,o=n(7294),i=n(7109),l=n(4585),c=n(9669),u=n.n(c),s=n(594),p=n(6867),d=n(2503),m=n(3564),f=n(5116),h=n(175),v=n(4524);function b(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var g=v.Z.div(r||(r=b(["\n\tposition: fixed;\n\ttop: 0;\n\tleft: 0;\n\tright: 0;\n\tbottom: 0;\n\tz-index: 1000;\n\tbackground-color: rgba(30, 30, 030, 0.5);\n"]))),O=v.Z.div(a||(a=b(["\n\tposition: absolute;\n\twidth: 500px;\n\theight: 550px;\n\tleft: 50%;\n\ttop: 50%;\n\ttransform: translate(-50%, -50%);\n\tz-index: 2000;\n\tdisplay: flex;\n\tflex-direction: column;\n\tbackground-color: #1e1e1e;\n\tbox-shadow:\n\t\t0 3px 1px -2px rgb(0 0 0 / 20%), 0 2px 2px 0 rgb(0 0 0 / 14%), 0 1px 5px 0 rgb(0 0 0 / 12%);\n\t\n\t& .close-icon {\n\t\tcolor: white;\n\t\tmargin-left: 430px;\n\t}\n\n\t& .qr-img {\n\t\twidth: 400px;\n\t\theight: 400px;\n\t\tmargin: 10px 45px 0 45px;\n\t}\n\n\t& .text-field {\n\t\tmargin: 20px;\n\n\t}\n\n\t& .css-14s5rfu-MuiFormLabel-root-MuiInputLabel-root {\n\t\tcolor: white;\n\t}\n\n\t& .css-1t8l2tu-MuiInputBase-input-MuiOutlinedInput-input {\n\t\tcolor: white;\n\t}\n\n\t& .css-1d3z3hw-MuiOutlinedInput-notchedOutline {\n\t\tborder-color: rgba(255, 255, 255, 0.6);\n\t}\n\n\t& .css-9ddj71-MuiInputBase-root-MuiOutlinedInput-root:hover .MuiOutlinedInput-notchedOutline {\n\t\tborder-color: rgba(255, 255, 255, 1);\n\n\t}\n\n\n\n\n\n\n\t\t"]))),y=n(2132);function x(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,o=[],i=!0,l=!1;try{for(n=n.call(t);!(i=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);i=!0);}catch(t){l=!0,a=t}finally{try{i||null==n.return||n.return()}finally{if(l)throw a}}return o}}(t,e)||function(t,e){if(t){if("string"==typeof t)return I(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?I(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var w,k,C,E=function(){var t=(0,d.ZP)("/api/users/two-factor-status",m.Z).data,e=x((0,o.useState)(!1),2),n=e[0],r=e[1],a=x((0,o.useState)(""),2),i=a[0],c=a[1],v=x((0,o.useState)(!1),2),b=v[0],I=v[1],w=x((0,o.useState)(""),2),k=w[0],C=w[1];(0,o.useEffect)((function(){t&&r(t)}),[t]);var E=(0,o.useCallback)((function(t){"Enter"===t.key&&u().get("/api/auth/otpCodeCheck/".concat(k),h.Z).then((function(t){!0===t.data?(C(""),u().get("/api/users/turn-on",h.Z).then((function(){y.Am.success("Successfully authenticated",{autoClose:3e3,position:y.Am.POSITION.TOP_RIGHT,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,theme:"colored"}),r(!0),I(!1)})).catch((function(t){y.Am.error(t.message,{autoClose:3e3,position:y.Am.POSITION.TOP_RIGHT,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,theme:"colored"})}))):y.Am.error("Authenticate failed",{autoClose:3e3,position:y.Am.POSITION.TOP_RIGHT,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,theme:"colored"})})).catch((function(t){y.Am.error(t.message,{autoClose:3e3,position:y.Am.POSITION.TOP_RIGHT,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,theme:"colored"})}))}),[k]),A=(0,o.useCallback)((function(t){C(t.target.value)}),[k]),P=(0,o.useCallback)((function(t){!1===t.target.checked&&u().get("/api/users/turn-off",h.Z).then((function(){y.Am.success("Successfully turned off authentication",{autoClose:3e3,position:y.Am.POSITION.TOP_RIGHT,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,theme:"colored"}),r(!1)})).catch((function(t){y.Am.error(t.message,{autoClose:3e3,position:y.Am.POSITION.TOP_RIGHT,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,theme:"colored"}),r(!0)})),!0===t.target.checked&&u().get("/api/auth/make-qrcode",{withCredentials:!0,responseType:"blob"}).then((function(t){c(window.URL.createObjectURL(new Blob([t.data],{type:t.headers["content-type"]}))),r(!0)})).catch((function(t){y.Am.error(t.message,{autoClose:3e3,position:y.Am.POSITION.TOP_RIGHT,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,theme:"colored"}),r(!1)}))}),[]),S=(0,o.useCallback)((function(){n?(r(!1),I(!1)):I(!0)}),[b,n]);return o.createElement(o.Fragment,null,b&&n&&o.createElement(o.Fragment,null,o.createElement(g,{onClick:S}),o.createElement(O,null,o.createElement(p.Z,{className:"close-icon",onClick:S},o.createElement(s.Z,null)),o.createElement("img",{className:"qr-img",src:i}),o.createElement(f.Z,{className:"text-field",onKeyPress:E,onChange:A,value:k,id:"outlined-basic",label:"OTP",variant:"outlined",autoComplete:"off"}))),o.createElement(l.Z,{onClick:S,checked:!!n,onChange:P,inputProps:{"aria-label":"controlled"}}))},A=n(1170),P=n(2642);function S(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var T,N,Z=v.Z.div(w||(w=S(["\n\tdisplay: flex;\n\tflex-direction: column;\n\tcolor: white;\n\tmargin: 20px;\n\twidth: 100%;\n\tfont-size: 22px;\n\n\t& .security-wrapper {\n\t\twidth: 100%;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tpadding: 20px;\n\t\tbackground-color: #1e1e1e;\n\t}\n\n\t& .two-factor-wrapper {\n\t\tdisplay: flex;\n\t}\n\n\t& .user-avatar-container {\n\t\twidth: 100%;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tbackground-color: #1e1e1e;\n\t\tmargin-top: 25px;\n\t}\n\n\t& .user-avatar-wrapper {\n\t\tpadding: 20px 20px 20px 20px;\n\t}\n\n\t& .header-avatar {\n\t\theight: 70px;\n\t}\n\n\t& .user-avatar-upload-section {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t}\n\n\t& .avatar-upload-wrapper {\n\t\tposition: relative;\n\t}\n\n\t& .upload-input {\n\t\tdisplay: none;\n\t}\n\n\t& .avatar {\n\t\twidth: 180px;\n\t\theight: 180px;\n\t}\n\n\t& .remove-btn {\n\t\tposition: absolute;\n\t\ttop: -5px;\n\t\tright: -20px;\n\t\tz-index: 10;\n\t}\n\n\t& .remove-icon {\n\t\tcolor: white;\n\t}\n\n\t& .user-nickname {\n\t\tcolor: #52575d;\n\t\tfont-weight: 500;\n\t}\n\n\t& .upload-btn-wrapper {\n\t\twidth: 100%;\n\t\tmargin-top: 12px;\n\t}\n\n\t& .upload-btn {\n\t\twidth: 100%;\n\t}\n\t\n"])));function M(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}v.Z.div(k||(k=S(["\n\tbackground-color: #1e1e1e;\n\tmargin-top: 25px;\n\tdisplay: flex;\n\tflex-direction: column;\n\tpadding: 20px;\n\n\n\t& .nick-input-label {\n\t\tmargin-bottom: 10px;\n\t}\n\n\t& .css-1d3z3hw-MuiOutlinedInput-notchedOutline {\n\t\tborder-color: rgba(255, 255, 255, 0.6);\n\t}\n\n\t& .css-md26zr-MuiInputBase-root-MuiOutlinedInput-root:hover .MuiOutlinedInput-notchedOutline {\n\t\tborder-color: rgba(255, 255, 255, 1);\n\t}\n\n\t& .css-1t8l2tu-MuiInputBase-input-MuiOutlinedInput-input {\n\t\tcolor: white;\n\t}\n\n"]))),v.Z.div(C||(C=S(["\n\tcolor: red; \n\tfont-size: 14px; \n\tmargin-top: 5px;\n\tvisibility: ",";\n"])),(function(t){return t.visibility}));var j=v.Z.div(T||(T=M(["\n\tbackground-color: #1e1e1e;\n\tmargin-top: 25px;\n\tdisplay: flex;\n\tflex-direction: column;\n\tpadding: 20px;\n\n\n\t& .nick-input-label {\n\t\tmargin-bottom: 10px;\n\t}\n\n\t& .css-1d3z3hw-MuiOutlinedInput-notchedOutline {\n\t\tborder-color: rgba(255, 255, 255, 0.6);\n\t}\n\n\t& .css-md26zr-MuiInputBase-root-MuiOutlinedInput-root:hover .MuiOutlinedInput-notchedOutline {\n\t\tborder-color: rgba(255, 255, 255, 1);\n\t}\n\n\t& .css-1t8l2tu-MuiInputBase-input-MuiOutlinedInput-input {\n\t\tcolor: white;\n\t}\n\n"]))),H=v.Z.div(N||(N=M(["\n\tcolor: red; \n\tfont-size: 14px; \n\tmargin-top: 5px;\n\tvisibility: ",";\n"])),(function(t){return t.visibility}));function B(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,o=[],i=!0,l=!1;try{for(n=n.call(t);!(i=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);i=!0);}catch(t){l=!0,a=t}finally{try{i||null==n.return||n.return()}finally{if(l)throw a}}return o}}(t,e)||function(t,e){if(t){if("string"==typeof t)return z(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?z(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var R=function(){var t=(0,d.ZP)("/api/users",m.Z),e=(t.data,t.mutate),n=B((0,o.useState)(""),2),r=n[0],a=n[1],i=B((0,o.useState)(0),2),l=i[0],c=i[1],s=(0,o.useCallback)((function(t){t.preventDefault(),a(t.target.value),c(0)}),[]),p=(0,o.useCallback)((function(t){r&&(r.length>10?c(2):"Enter"===t.key&&(t.preventDefault(),u().get("/api/users/update-username/".concat(r),{withCredentials:!0}).then((function(t){!1!==t.data?(y.Am.success("Successfully changed your nickname",{autoClose:3e3,position:y.Am.POSITION.TOP_RIGHT,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,theme:"colored"}),e(),a("")):c(1)})).catch((function(t){y.Am.error(t.message,{autoClose:3e3,position:y.Am.POSITION.TOP_RIGHT,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,theme:"colored"})}))))}),[e,r]);return o.createElement(j,null,o.createElement("span",{className:"nick-input-label"},"Edit nickname"),o.createElement(f.Z,{value:r,onChange:s,onKeyUp:p,fullWidth:!0,label:"nickname",id:"fullWidth",autoComplete:"off"}),o.createElement(H,{visibility:0===l?"hidden":"visiblle"},l&&1===l?o.createElement("span",null,"This nickname is already in use by another user"):o.createElement("span",null,"Nickname length limit is 10 characters")))};function G(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,o=[],i=!0,l=!1;try{for(n=n.call(t);!(i=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);i=!0);}catch(t){l=!0,a=t}finally{try{i||null==n.return||n.return()}finally{if(l)throw a}}return o}}(t,e)||function(t,e){if(t){if("string"==typeof t)return _(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var U=function(){var t=(0,d.ZP)("/api/users",m.Z),e=t.data,n=t.mutate,r=G((0,o.useState)(null),2),a=r[0],l=r[1],c=G((0,o.useState)(""),2),f=c[0],h=c[1],v=(0,o.useCallback)((function(){var t,r;if(a&&a[0]){var o=new FormData;o.append("image",a[0],"".concat(null==e?void 0:e.userId)+a[0].name.slice(null===(t=a[0])||void 0===t||null===(r=t.name)||void 0===r?void 0:r.indexOf("."))),u().post("/api/users/upload",o,{withCredentials:!0,headers:{"content-type":"multipart/form-data"}}).then((function(t){y.Am.success("Successfully changed your profile picture",{autoClose:3e3,position:y.Am.POSITION.TOP_RIGHT,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,theme:"colored"}),n()})).catch((function(t){y.Am.error(t.message,{autoClose:3e3,position:y.Am.POSITION.TOP_RIGHT,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,theme:"colored"})}))}}),[e,a]);(0,o.useEffect)((function(){b()}));var b=function(){if(!a||!a[0])return!1;var t=new FileReader;t.onload=function(){h("".concat(t.result))},t.readAsDataURL(a[0])};return o.createElement(Z,null,o.createElement("div",{className:"security-wrapper"},o.createElement("div",null,"Security"),o.createElement("div",{className:"two-factor-wrapper"},o.createElement(E,null),o.createElement("span",null,"2-Factor Authentication"))),o.createElement("div",{className:"user-avatar-container"},o.createElement("div",{className:"user-avatar-wrapper"},o.createElement("div",{className:"header-avatar"},"Avatar"),o.createElement("div",{className:"user-avatar-upload-section"},o.createElement("div",{className:"avatar-upload-wrapper"},o.createElement("label",{htmlFor:"contained-button-file"},o.createElement("input",{className:"upload-input",accept:"image/*",id:"contained-button-file",multiple:!0,type:"file",onChange:function(t){l(t.target.files)}}),o.createElement(i.Z,{className:"avatar",src:f||(null==e?void 0:e.profile),alt:"Avatar"})),o.createElement("div",{className:"remove-btn ",onClick:function(){h(""),l(null)}},o.createElement(p.Z,{className:"remove-icon"},o.createElement(s.Z,null)))),o.createElement("span",null,null==e?void 0:e.userId),o.createElement("span",{className:"user-nickname"},null==e?void 0:e.username),o.createElement("div",{className:"upload-btn-wrapper"},o.createElement(P.Z,{className:"upload-btn",variant:"contained",startIcon:o.createElement(A.Z,null),component:"span",onClick:v},"Upload"))))),o.createElement(R,null))}}}]);