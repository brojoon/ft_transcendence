Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react");function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(require("swr"));function r(e,t,n,r){return new(n||(n=Promise))(function(u,a){function i(e){try{l(r.next(e))}catch(e){a(e)}}function o(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?u(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,o)}l((r=r.apply(e,t||[])).next())})}function u(e,t){var n,r,u,a,i={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(u=2&a[0]?r.return:a[0]?r.throw||((u=r.return)&&u.call(r),0):r.next)&&!(u=u.call(r,a[1])).done)return u;switch(r=0,u&&(a=[2&a[0],u.value]),a[0]){case 0:case 1:u=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(u=i.trys,(u=u.length>0&&u[u.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!u||a[1]>u[0]&&a[1]<u[3])){i.label=a[1];break}if(6===a[0]&&i.label<u[1]){i.label=u[1],u=a;break}if(u&&i.label<u[2]){i.label=u[2],i.ops.push(a);break}u[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=u=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}}var a="undefined"==typeof window||"Deno"in window,i=a?e.useEffect:e.useLayoutEffect,o="undefined"!=typeof navigator&&navigator.connection;!a&&o&&(["slow-2g","2g"].includes(o.effectiveType)||o.saveData);var l={}[0],c=function(e){return e===l},f=function(e){return"function"==typeof e},s=new WeakMap,v=0;function p(e){if(f(e))try{e=e()}catch(t){e=""}var t;return Array.isArray(e)?(t=e,e=function(e){if(!e.length)return"";for(var t="arg",n=0;n<e.length;++n){var r=e[n],u=l;null===r||"object"!=typeof r&&!f(r)?u=JSON.stringify(r):s.has(r)?u=s.get(r):(u=v,s.set(r,v++)),t+="$"+u}return t}(e)):t=[e=String(e||"")],[e,t,e?"$err$"+e:"",e?"$req$"+e:""]}function d(e){return f(e[1])?[e[0],e[1],e[2]||{}]:[e[0],null,(null===e[1]?e[2]:e[1])||{}]}var y=function(e){return p(e?e(0,null):null)[0]},b=function(t){return function(n,a,o){var s=o.cache,v=o.initialSize,d=void 0===v?1:v,b=o.revalidateAll,h=void 0!==b&&b,g=o.persistSize,w=void 0!==g&&g,$=null;try{$=y(n)}catch(e){}var x=e.useState({})[1],k=null;$&&(k="$ctx$"+$);var m=null;$&&(m="$len$"+$);var S=e.useRef(!1),z=e.useCallback(function(){var e=s.get(m);return c(e)?d:e},[m,d]),j=e.useRef(z());i(function(){S.current?$&&s.set(m,w?j.current:d):S.current=!0},[$]);var q=e.useRef(),A=t($?"$inf$"+$:null,function(){return r(void 0,void 0,void 0,function(){var e,t,r,i,l,f,v,d,y,b,g,w;return u(this,function(u){switch(u.label){case 0:e=s.get(k)||[],t=e[0],r=e[1],i=[],l=z(),f=null,v=0,u.label=1;case 1:return v<l?(d=p(n?n(v,f):null),y=d[0],b=d[1],y?(g=s.get(y),w=h||t||c(g)||!v&&!c(q.current)||r&&!c(r[v])&&!o.compare(r[v],g),a&&w?[4,a.apply(void 0,b)]:[3,3]):[3,5]):[3,5];case 2:g=u.sent(),s.set(y,g),u.label=3;case 3:i.push(g),f=g,u.label=4;case 4:return++v,[3,1];case 5:return s.delete(k),[2,i]}})})},o);i(function(){q.current=A.data},[A.data]);var C=e.useCallback(function(e,t){if(void 0===t&&(t=!0),k){if(t&&!c(e)){var n=q.current;s.set(k,[!1,n])}else t&&s.set(k,[!0]);return A.mutate(e,t)}},[k]),E=e.useCallback(function(e){var t;if(m&&(f(e)?t=e(z()):"number"==typeof e&&(t=e),"number"==typeof t))return s.set(m,t),j.current=t,x({}),C(function(e){for(var t=[],r=null,u=0;u<e;++u){var a=p(n?n(u,r):null)[0],i=a?s.get(a):l;if(c(i))return q.current;t.push(i),r=i}return t}(t))},[m,z,C]);return{size:z(),setSize:E,mutate:C,get error(){return A.error},get data(){return A.data},get isValidating(){return A.isValidating}}}},h=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var u=d(n),a=u[0],i=u[1],o=u[2];return o.use=(o.use||[]).concat(t),e(a,i,o)}}(n.default,b);exports.default=h,exports.infinite=b,exports.unstable_serialize=function(e){return"$inf$"+y(e)};
